var init  = require('./');
var r     = require('rethinkdb');

var options = {
  host: 'localhost',
  port: 28015,
  db: 'test'
};

var schema = {
  comments11: {
    options: {
      primaryKey: 'id',
      durability: 'hard',
      shards: 1,
      replicas: 1
    },
    indexes: {
      author: true,
      article: true,
      location: { geo: true },
      tags: { multi: true }
    }
  },
  posts24: {
    indexes: {
      author: true
    }
  }
}

function connect(opts, cb) {
  r.connect(options, function(err, connection) {
    if (err) return cb(err);
    init(schema, r, connection, cb);
  });
}

connect(options, function(err, conn) {
  if (err) return console.log('Error:', err);
  console.log('Tables and indexes are synced');
});
